<html>
 <!--
* PyWebCopy Engine [version 7.0.2]
* Copyright 2020; Raja Tomar
* File mirrored from [http://bigor.bmstu.ruA:/BIGOR/App/my_site/bigor.bmstu.ru/cnt__doc_OP2_mem2.mod__cou_OP2_OP_T.cou.html"]
* At UTC datetime: [2022-12-19 15:48:57.903310]
-->
 <head>
  <title>
   Ôóíêöèè óïðàâëåíèÿ äèíàìè÷åñêîé ïàìÿòüþ
  </title>
  <meta content="Ôåäîðóê Åëåíà Âëàäèìèðîâíà" name="Author"/>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="index, nofollow" name="Robots"/>
  <script language="JavaScript">
   function feedback(act, txt) {
document.forms['FBForm'].action='/?'+act+'/?'+document.location.href;
document.getElementById('FB').value=txt;
document.forms['FBForm'].submit(); }

function on(obj) { obj.style.textDecoration='underline'; }
function off(obj) { obj.style.textDecoration='none'; }

function imgscale(img, k) { img.width=img.width*k; }

var cs=null;
function selStop() { if(document.selection != null) cs=document.selection.createRange(); }
function selStart() { cs=null; }

function termSearch() { if(cs == null || cs.text.length == 0) feedback('sht',''); else { cs.select(); feedback('sht',cs.text); } cs=null; }
function termInfo(txt) { feedback('trm',txt); } function termInfoExt(txt) { feedback('tre',txt); }

function jobchange(cb) {
document.getElementById('ChJob').value=(cb.checked ? '+':'-')+' '+cb.id;
document.forms['FJob'].submit(); }

function jobchangeall(cb) {
document.getElementById('ChGrJob').value=cb.id+' '+document.location.href;
document.forms['FGrJob'].action += document.location.href+'#S'+document.body.scrollTop;
document.forms['FGrJob'].submit(); }

function iniscroll() {
var s = new String(document.location.hash); if(s.length < 3 || s.charAt(1) != new String('S')) return;
document.body.scrollTop = s.substring(2); }

var bx=0, by=0, bw=0, bh=0;
var box=null, tit=null, txt=null;
var his=null;
var dx=0, dy=0, dflg=0;

function puInit() { 
box=document.getElementById('PopUp'); 
tit=document.getElementById('PopUpTitle'); 
txt=document.getElementById('PopUpText');
puClose(); tit.style.cursor='default';
bw = document.body.scrollWidth*0.55; if(bw < 350) bw = 350;
bx = (document.body.scrollWidth-bw)/2-3; by=50;
txt.style.width=bw; box.style.top=-1000;
if(box.filters != null) box.style.filter='revealtrans(transition=1)'; }

function puClose() {
if(box == null) return;
dFlg=0; txt.style.height=80; his=null;
box.style.top=-1000;
box.style.visibility='hidden'; }

function puOpen() {
if(box == null) return;
if(box.filters != null && his == null) box.filters.item(0).Apply();
dFlg=0;
var v = ''; var t = new String(FPopUp.document.title);
if(t == null || t.length == 0) { document.location.href=new String(document.location.href); return; }
if(t.charAt(0) == '!') { t = t.substring(1); v = 'hidden'; }
document.getElementById('PopUpBack').style.visibility = v; 
document.getElementById('PopUpForw').style.visibility = v;
tit.innerHTML=t;
bh = FPopUp.document.body.scrollHeight+6; if(bh > 500) bh = 500; else if(bh < 100) bh = 100;
txt.style.height=bh;
box.style.left=document.body.scrollLeft+bx; 
box.style.top=document.body.scrollTop+by;
box.style.visibility='visible';
if(box.filters != null && his == null) box.filters.item(0).play(0.3);
if(his == null) his=FPopUp.document.location.href; }

function puScroll() {
if(his == null) return;
box.style.left=document.body.scrollLeft+bx;
box.style.top=document.body.scrollTop+by; }

function puForw() {
FPopUp.history.forward(); }

function puBack() {
if(FPopUp.document.location.href == his) return;
FPopUp.history.back(); }

function puMove(ev) {
if(dflg == 0) return;
bx = bx+(ev.screenX-dx); box.style.left=document.body.scrollLeft+bx; dx=ev.screenX;
by = by+(ev.screenY-dy); box.style.top=document.body.scrollTop+by; dy=ev.screenY;
ev.cancelBubble=true; }

function puStart(ev) {
if(ev.button > 1) return;
dflg=1; tit.style.cursor='move';
dx=ev.screenX; dy=ev.screenY; }

function puStop() {
tit.style.cursor='default'; dflg=0; }
  </script>
  <style type="text/css">
   .menu { padding-left:6px; padding-right:6px; }
.menuLnk { color:#000000; font-family:sans-serif; font-size:12px; text-decoration:none; }
.puTitle { background-color:#7070FF; text-align:center; height:21px; margin-top:1px; font-family:sans-serif; font-weight:bold; color:white; font-size:15px; letter-spacing:1px; }
.eTermI { font-size:100%; color:#0000FF; text-decoration:none; }
.eExample { font-size:90%; font-family:verdana,sans-serif; margin-left:9.0pt; text-align:justify; margin-bottom:7pt; }
.eImageTxt { font-size:12.5pt; text-indent:0pt; font-family:serif; font-weight:bold; font-style:normal; margin-top:10pt; margin-bottom:4pt; padding-bottom:5px; margin-left:0px; }
.dModul { font-size:15.0px; font-family:verdana,sans-serif; text-indent:25.0px; margin-left:6pt; margin-right:6pt; text-align:justify; }
.eSubTitle { font-size:13.5pt; color:#0000FF; font-family:sans-serif; font-weight:bold; text-indent:25pt; text-align:left; margin-top:10pt; margin-bottom:3.5pt; }
.eTermO { font-size:100%; color:#FF0000; letter-spacing:1px; font-style:italic; text-decoration:none; }
.auto { font-size:12.5pt; text-indent:0pt; font-family:serif; font-weight:bold; font-style:normal; margin-top:10pt; margin-bottom:4pt; margin-left:30.0pt; }
.eImage { text-align:center; margin-top:11pt; margin-bottom:3pt; }
.eTitleModul { font-size:25.5pt; color:#0000FF; text-align:center; font-family:serif; font-weight:bold; margin-bottom:8pt; margin-top:0pt; text-indent:0pt; text-decoration:none; }
.eOperator { font-family:monospace; font-weight:bold; font-style:normal; font-size:115%; }
.eListing { font-family:monospace; font-weight:bold; font-style:normal; font-size:115%; text-indent:0pt; padding-left:20pt; margin-top:5pt; margin-bottom:4pt; }
  </style>
 </head>
 <body bottommargin="10" leftmargin="10" onload="puInit()" onmousemove="puMove(event)" onmouseup="puStop()" onresize="puInit()" onscroll="puScroll()" rightmargin="10" topmargin="10">
  <table bgcolor="#7070FF" border="1" id="PopUp" style="visibility:hidden; position:absolute">
   <tr>
    <td>
     <a href="javascript:puBack()" id="PopUpBack">
      <img align="left" alt="Назад" border="0" hspace="1" src="./asr_HTML_Back.gif" vspace="1"/>
     </a>
     <a href="javascript:puForw()" id="PopUpForw">
      <img align="left" alt="Вперед" border="0" hspace="1" src="./asr_HTML_Forw.gif" vspace="1"/>
     </a>
     <a href="javascript:puClose()">
      <img align="right" alt="Закрыть" border="0" hspace="1" src="./asr_HTML_Close.gif" vspace="1"/>
     </a>
     <div class="puTitle" id="PopUpTitle" onmousedown="puStart(event)">
     </div>
    </td>
   </tr>
   <tr>
    <td>
     <iframe frameborder="no" id="PopUpText" name="FPopUp" onload="puOpen()" scroll="auto">
     </iframe>
    </td>
   </tr>
  </table>
  <div style="display:none">
   <form method="POST" name="FBForm" target="FPopUp">
    <input id="FB" name="FB" type="HIDDEN"/>
   </form>
  </div>
  <div style="display:none">
   <form action="./jad" method="POST" name="FJob">
    <input id="ChJob" name="JText" type="TEXT"/>
   </form>
  </div>
  <div style="display:none">
   <form action="A:/BIGOR/App/my_site/bigor.bmstu.ru/cnt__doc_OP2_OP_T.cou.html"" method="POST" name="FGrJob">
    <input id="ChGrJob" name="JText" type="TEXT"/>
   </form>
  </div>
  <div id="Content" onmousedown="puClose()">
   <noindex>
    <center>
     <table border="0" cellpadding="0" cellspacing="0">
      <tr align="center" valign="top">
       <td class="menu">
        <a class="menuLnk" href="A:/BIGOR/App/my_site/bigor.bmstu.ru/cnt__doc_OP2_OP_T.cou.html"">
         <img border="0" src="./asr_HTML_Home.gif"/>
         <br/>
         Главная страница
        </a>
       </td>
       <td>
       </td>
       <td class="menu">
        <a class="menuLnk" href="./cnt__doc_OP2_OP_T.cou.html"">
         <img border="0" src="./asr_HTML_Content.gif"/>
         <br/>
         Оглавление курса
        </a>
       </td>
       <td class="menu">
        <a class="menuLnk" href="./cnt__doc_OP2_mem1.mod__cou_OP2_OP_T.cou.html"">
         <img border="0" src="./asr_HTML_ModulBack.gif"/>
         <br/>
         Предыдущий модуль
        </a>
       </td>
       <td class="menu">
        <a class="menuLnk" href="./cnt__doc_OP2_dina.mod__cou_OP2_OP_T.cou.html"">
         <img border="0" src="./asr_HTML_ModulForw.gif"/>
         <br/>
         Следующий модуль
        </a>
       </td>
       <td class="menu">
        <a class="menuLnk" href="javascript:termSearch()">
         <img border="0" src="./asr_HTML_TSearch.gif"/>
         <br/>
         Поиск терминов
        </a>
       </td>
       <td>
       </td>
       <td class="menu">
        <a class="menuLnk" href="./sty__cnt__doc_OP2_mem2.mod__cou_OP2_OP_T.cou.html"__bck_OP2_mem2.mod" target="FPopUp">
         <img border="0" src="./asr_HTML_Setup.gif"/>
         <br/>
         Настройки
        </a>
       </td>
       <td>
       </td>
       <td class="menu">
        <a class="menuLnk" href="./cnt__prn_y__doc_OP2_mem2.mod">
         <img border="0" src="./asr_HTML_Print.gif"/>
         <br/>
         Версия для печати
        </a>
       </td>
       <td>
       </td>
      </tr>
     </table>
    </center>
   </noindex>
   <hr width="90%"/>
   <div class="dModul" onmousedown="selStart()" onmouseout="selStop()" onmouseup="selStop()">
    <div class="eTitleModul">
     <a class="eTitleModul" href="./met__doc_OP2_mem2.mod__cou_OP2_OP_T.cou.html"__bck_OP2_mem2.mod" onmouseout="off(this)" onmouseover="on(this)" target="FPopUp" title="Показать метаданные документа">
      Функции управления динамической памятью
     </a>
    </div>
    <a name="T1472977186">
    </a>
    <div>
     <a class="eTermO" href="javascript:termInfo(%22%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%B8%20%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%B4%D0%B8%D0%BD%D0%B0%D0%BC%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B9%20%D0%BF%D0%B0%D0%BC%D1%8F%D1%82%D1%8C%D1%8E%22)" onmouseout="off(this)" onmouseover="on(this)">
      Функции управления динамической памятью
     </a>
     дают возможность легко управлять памятью.
    </div>
    <div>
     Они являются
     <a class="eTermI" href="javascript:termInfo(%22%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F%D0%BC%D0%B8%22)" onmouseout="off(this)" onmouseover="on(this)">
      функциями
     </a>
     <a class="eTermI" href="javascript:termInfo(%22%D0%B1%D0%B8%D0%B1%D0%BB%D0%B8%D0%BE%D1%82%D0%B5%D0%BA%D0%B8%22)" onmouseout="off(this)" onmouseover="on(this)">
      библиотеки
     </a>
     общего назначения.
    </div>
    <div>
     Объявления этих функций находится в
     <a class="eTermI" href="javascript:termInfo(%22%D1%84%D0%B0%D0%B9%D0%BB%20%D0%B7%D0%B0%D0%B3%D0%BE%D0%BB%D0%BE%D0%B2%D0%BA%D0%BE%D0%B2%22)" onmouseout="off(this)" onmouseover="on(this)">
      заголовочном файле
     </a>
     <span class="eOperator">
      &lt;stdlib.h&gt;
     </span>
     , поэтому в программах, использующих эти функции, необходимо включать следующую
     <a class="eTermI" href="javascript:termInfo(%22%D0%B4%D0%B8%D1%80%D0%B5%D0%BA%D1%82%D0%B8%D0%B2%D1%83%20%D0%BF%D1%80%D0%B5%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81%D0%BE%D1%80%D0%B0%22)" onmouseout="off(this)" onmouseover="on(this)">
      директиву препроцессора
     </a>
     :
    </div>
    <div>
     <span class="eOperator">
      #include &lt;stdlib.h&gt;
     </span>
    </div>
    <div class="eSubTitle">
     Выделение памяти
    </div>
    <div>
     <span class="eOperator">
      void * malloc(size_t size)
     </span>
    </div>
    <div>
     Функция выделяет память размером
     <span class="eOperator">
      size
     </span>
     и возвращает адрес начала области памяти. При присвоении указателю происходит явное преобразование типа. Выравнивание границы происходит автоматически, но выделенная память не инициируется нулями.
    </div>
    <div>
     <span class="eOperator">
      void realloc (void *block, size_t size)
     </span>
    </div>
    <div>
     Функция делает размер блока по указателю
     <span class="eOperator">
      block
     </span>
     равным
     <span class="eOperator">
      size
     </span>
     байтов и возвращает указатель на блок, возможно перемещенный. В случае перемещения блока данные из исходного блока копируются в новый блок, освобождая исходный блок.
    </div>
    <div>
     <span class="eOperator">
      void * сalloc(size_t nelem, size_t elsize)
     </span>
    </div>
    <div>
     Функция выделяет блок, который вмещает
     <span class="eOperator">
      nelem
     </span>
     элементов размером
     <span class="eOperator">
      elsize
     </span>
     байтов каждый, возвращает адрес начала области памяти. Выделенная память инициируется нулями.
    </div>
    <div>
     У каждого блока памяти есть байты, где хранятся длина блока и признак того, занят он или свободен. Эти функции управления памятью используют системные вызовы
     <span class="eOperator">
      brk
     </span>
     и
     <span class="eOperator">
      sbrk
     </span>
     . Когда функциям
     <span class="eOperator">
      malloc
     </span>
     ,
     <span class="eOperator">
      сalloc
     </span>
     и
     <span class="eOperator">
      realloc
     </span>
     нужно изменить границу выделяемой памяти, они обычно делают это с запасом. Если будущим запросам хватает выделенного пространства, они не используют системный вызов. Так библиотечные функции минимизируют число выполнения системных вызовов.
    </div>
    <div>
     Если вызов функции закончился неуспешно, то она возвращает значение
     <span class="eOperator">
      NULL
     </span>
     .
    </div>
    <div class="eSubTitle">
     Освобождение памяти
    </div>
    <div>
     <span class="eOperator">
      void free(void *block)
     </span>
    </div>
    <div>
     Функция освобождает блок памяти по указателю
     <span class="eOperator">
      *block
     </span>
     и делает его доступным для последующих выделений памяти. Указатель должен указывать на блок, полученный ранее вызовом
     <span class="eOperator">
      malloc
     </span>
     ,
     <span class="eOperator">
      calloc
     </span>
     или
     <span class="eOperator">
      realloc
     </span>
     .
    </div>
    <div>
     Функция
     <span class="eOperator">
      free()
     </span>
     никогда не возвращает память назад ядру. Вместо этого она устанавливает признак того, что блок свободен. Будущие запросы выделения памяти ищут среди всех свободных блоков блок подходящего размера, прежде чем использовать системный вызов увеличения памяти. Смежные свободные блоки сливаются во время поиска для их более эффективного переиспользования.
    </div>
    <div class="auto">
     Пример 1
    </div>
    <div class="eExample">
     <pre class="eListing">int *a;

if ((a=(int *)malloc(sizeof(int)))==NULL) /* выделение памяти под целое типа int*/
  {
   printf("Не хватает памяти для числа.");
   exit(1);
   }
*a=-244;
*a+=10;
free(a);                /* освобождение памяти*/
</pre>
    </div>
    <div class="auto">
     Пример 2
    </div>
    <div class="eExample">
     <pre class="eListing">struct node {
             int         data;
             struct node *next;
             };
struct node *pnode;
if ((pnode = malloc(sizeof(struct node)))==NULL) /* выделение памяти под структуру node*/
  {
   printf("Не хватает памяти для структуры.");
   exit(1);
   }
pnod-&gt;data=100;
pnod-&gt;next=NULL;
</pre>
    </div>
    <div class="auto">
     Пример 3
    </div>
    <div class="eExample">
     <pre class="eListing">int *array;
/* выделение памяти под массив из 3 элементов  типа int*/
                                /*элементы массива равны 0*/
if ((array = calloc(3, sizeof(int)))==NULL) /* выделение памяти под структуру node*/
  {
   printf("Не хватает памяти для массива.");
   exit(1);
   }
for (i=0; i&lt;3; i++, array++)
   *array=i+1;
</pre>
    </div>
    <div class="auto">
     Пример 4
    </div>
    <div class="eExample">
     <pre class="eListing">struct node {
            int          data;
            struct node *next;
            };
struct node *table;
if ((table = calloc(3, sizeof(struct node)))==NULL)
  {
   printf("Не хватает памяти для массива структур.");
   exit(1);
   }

</pre>
     <div>
      Выделяется память под
      <a class="eTermI" href="javascript:termInfo(%22%D0%BC%D0%B0%D1%81%D1%81%D0%B8%D0%B2%22)" onmouseout="off(this)" onmouseover="on(this)">
       массив
      </a>
      из трех элементов
      <a class="eTermI" href="javascript:termInfo(%22%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%82%D1%83%D1%80%22)" onmouseout="off(this)" onmouseover="on(this)">
       структур
      </a>
      <span class="eOperator">
       node
      </span>
      . Ссылаться на элементы можно как
     </div>
     <div>
      в любом другом массиве.
     </div>
     <div>
      <span class="eOperator">
       table[2].data = 3;
      </span>
     </div>
    </div>
    <div class="auto">
     Пример 5
    </div>
    <div class="eExample">
     <div>
      Вставка узла в список структур
     </div>
     <pre class="eListing">struct node {
            int          data;
            struct node *next;
            };
struct node *insert (struct node *p, int i) /*вставка узла после узла *P*/
{struct node *q;
if ((q= malloc(sizeof(struct node)))==NULL)
  {
   printf("Не хватает памяти для структуры.");
   exit(1);
   }
q-&gt;next = p-&gt;next;
q-&gt;data = i;
p-&gt;next = q;
return (g);
}
</pre>
     <div class="eImage">
      <table align="center" border="1" bordercolordark="#0000FF" bordercolorlight="#0000FF" cellpadding="6" cellspacing="0">
       <tr>
        <td>
         <img src="./img__doc_OP2_mem2.mod__n_1.png"/>
        </td>
       </tr>
      </table>
      <div class="eImageTxt">
       Рис. 1.  Вставка узла
      </div>
     </div>
    </div>
    <div class="auto">
     Пример 6
    </div>
    <div class="eExample">
     <div>
      Уничтожение узла в списке структур
     </div>
     <pre class="eListing">void delete (struct node *p)
{ struct node *q;
  q = p-&gt;next;
  p-&gt;data=q-&gt;data;
  p-&gt;next=q-&gt;next;
  free (q);
}
</pre>
     <div>
      Эта функция уничтожает данные, содержащиеся в узле с указателем
      <span class="eOperator">
       p
      </span>
      . Данные в узле с указателем
      <span class="eOperator">
       q
      </span>
      копируются в узел с указателем
      <span class="eOperator">
       p
      </span>
      . Потом узел
      <span class="eOperator">
       q
      </span>
      уничтожается. Чтобы этот алгоритм уничтожения работал со всеми узлами, включая последний в списке, пустой список должен содержать голову
      <span class="eOperator">
       head
      </span>
      и узел с нулевым указателем в поле
      <span class="eOperator">
       next
      </span>
      . Другими словами, последний узел является ограничителем и его нельзя уничтожать. Поэтому в программу надо включить следующую проверку:
     </div>
     <div>
      <span class="eOperator">
       if(p-&gt;next==NULL) return;
      </span>
     </div>
    </div>
    <div class="eImage">
     <table align="center" border="1" bordercolordark="#0000FF" bordercolorlight="#0000FF" cellpadding="6" cellspacing="0">
      <tr>
       <td>
        <img src="./img__doc_OP2_mem2.mod__n_2.png"/>
       </td>
      </tr>
     </table>
     <div class="eImageTxt">
      Рис. 2.  Уничтожение узла
     </div>
    </div>
   </div>
   <hr width="90%"/>
   <noindex>
    <center>
     <table border="0" cellpadding="0" cellspacing="0">
      <tr align="center" valign="top">
       <td class="menu">
        <a class="menuLnk" href="A:/BIGOR/App/my_site/bigor.bmstu.ru/cnt__doc_OP2_OP_T.cou.html"">
         <img border="0" src="./asr_HTML_Home.gif"/>
         <br/>
         Главная страница
        </a>
       </td>
       <td>
       </td>
       <td class="menu">
        <a class="menuLnk" href="./cnt__doc_OP2_OP_T.cou.html"">
         <img border="0" src="./asr_HTML_Content.gif"/>
         <br/>
         Оглавление курса
        </a>
       </td>
       <td class="menu">
        <a class="menuLnk" href="./cnt__doc_OP2_mem1.mod__cou_OP2_OP_T.cou.html"">
         <img border="0" src="./asr_HTML_ModulBack.gif"/>
         <br/>
         Предыдущий модуль
        </a>
       </td>
       <td class="menu">
        <a class="menuLnk" href="./cnt__doc_OP2_dina.mod__cou_OP2_OP_T.cou.html"">
         <img border="0" src="./asr_HTML_ModulForw.gif"/>
         <br/>
         Следующий модуль
        </a>
       </td>
       <td class="menu">
        <a class="menuLnk" href="javascript:termSearch()">
         <img border="0" src="A:/BIGOR/App/my_site/bigor.bmstu.ru/asr_HTML_TSearch.gif"/>
         <br/>
         Поиск терминов
        </a>
       </td>
       <td>
       </td>
       <td class="menu">
        <a class="menuLnk" href="/?styA:/BIGOR/App/my_site/bigor.bmstu.ru/cnt__doc_OP2_mem2.mod__cou_OP2_OP_T.cou.html"/?bck=OP2/mem2.mod" target="FPopUp">
         <img border="0" src="A:/BIGOR/App/my_site/bigor.bmstu.ru/asr_HTML_Setup.gif"/>
         <br/>
         Настройки
        </a>
       </td>
       <td>
       </td>
       <td class="menu">
        <a class="menuLnk" href="/?cnt/?prn=y/?doc=OP2/mem2.mod">
         <img border="0" src="A:/BIGOR/App/my_site/bigor.bmstu.ru/asr_HTML_Print.gif"/>
         <br/>
         Версия для печати
        </a>
       </td>
       <td>
       </td>
      </tr>
     </table>
    </center>
   </noindex>
  </div>
 </body>
</html>